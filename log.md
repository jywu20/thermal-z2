# 2021.9.1

`ising-chain-prototype\2021-9-1-old` is created using previous codes.

By running `transverse_ising-1d-with-ani-ising.jl` two images about magnetization are created.

`ising-chain-prototype\2021-9-1-old` is then rewritten into a more modularized version, stored in `ising-chain-prototype\2021-9-1-revised`.

`ising-chain-prototype\2021-9-1-revised` is later used to created `ising-field-coupling-prototype\2021-9-1`.

# 2021.9.7

`ising-chain-prototype\2021-9-1-revised` is copied to `src\pure-z2`, as the prototype of the final version
of pure $\mathbb{Z}_2$ gauge field simulation.

`src\pure-z2\magnetization.PNG` and `src\pure-z2\magnetic-susceptibility.PNG` are created using `magnetic-ordering.jl`.
Console output:

> Progress: 100%|██████████████████████████████████████████████████████████████████████| Time: 0:20:04    

`src\pure-z2\wilson-loop.jl` is created. A rough test indicates that it works well, since systems predicted to be
deconfined obeys the perimeter law, while systems predicted to be confined obeys the area law.

Further tests may be needed, to find out:
- why the transition point seem to be $h = 1.2$ instead of $h = 1$
- what is the best choice of $T$
- how to simulate the finite temperature case

# 2021.9.8 

Add introduction of orthogonal metals into `docs/note.tex`.

`phase-diagram-transverse-ising-metropolis.PNG` and `phase-diagram-transverse-ising-wolff.PNG` are copied from `visconfs` to `docs/phase`.

Deprecated `fermion-coupling-prototype/hopping-hamiltonian.jl`. The file is moved into `deprecated`.

# 2021.9.10

Rename `src/pure-z2` to `src/pure-z2-mapped-to-spin-chain`, 
because it seems that with a strong transverse field, 
we cannot simply map a $\mathbb{Z}_2$ gauge field into a bundle of spin chains.

Create `analytical` folder for calculating and plotting analytical results.

# 2021.9.11

`2d-tfim-to-3d-cim.jl` and `2d-tfim-to-3d-cim-prototype.jl` are moved into `analytical/jxy-jtau-ratio`.

`2d-tfim-to-3d-cim.jl` is used to create `ratio-h=1.PNG` and `ratio-h=4.PNG`.
They are copied to `docs/montecarlo`. 

# 2021.9.12

Create `analytical/jxy-jtau-ratio/2d-tfim-to-3d-two-ways.jl` to check whether the two ways to calculate the effective interaction coefficient in the temporal direction, 
namely `-log.(tanh.(Δτ * h_range)) / 2` and `atanh.(exp.(- Δτ * h_range))`, agree.

It seems that they don't agree ...

After change `atanh.(exp.(- Δτ * h_range))` into `atanh.(exp.(- 2Δτ * h_range))` they agree. 
Update `docs/note.tex` for this change.

`src\pure-z2-mapped-to-spin-chain\anisotropic_ising.jl` is copied into `3d-ising-metropolis-prototype\wolff-3d.jl` and adjusted into a 3D Wolff algorithm, which is not tested yet.

# 2021.9.13

Add Metropolis algorithm in `3d-ising-metropolis-prototype`.

`magnetization-metropolis-ones-init.PNG` and other three images are created in `3d-ising-metropolis-prototype`.

It seems that for both Wolff algorithm and Metropolis algorithm, setting the initial field configuration to all-one
speeds up convergence.
This is different with the case in 2D.

Refactor `3d-ising-metropolis-prototype`.

# 2021.9.19

`3d-ising-metropolis-prototype` is renamed to `3d-ising-prototype`.
In `3d-ising-prototype/examples`, all isotropic data is moved to `isotropic`.

A new folder named `transverse` is created for simulation of 2D TFIM.
`tfim-2d-magnetic-susceptibility-wolff-from-ones.PNG` and `tfim-2d-magnetization-wolff-from-ones.PNG` are created using `3d-ising-prototype/examples/transverse/tfim-2d-magnetization-wolff-from-ones.jl`.

Create folder `src/pure-z2-dual-tfim`.

# 2021.9.21

After discussion with Yang Qi, we conclude that
- the gauge choice in (Moon, 2019) is wrong, and
- the perturbation theory is not well justified, and
- it is better to simulate $\mathbb{Z}_2$ gauge field as it is, instead of transform it into a model without gauge redundancy

TODO:
- read an article about QMC of $\mathbb{Z}_2$ gauge theory by Sachdev and others.

# 2021.9.23

Rename `z2-magnetization-wolff-from-ones.jl` into `z2-magnetization-wolff-from-ones-proto.jl`.

Copy `z2-magnetization-wolff-from-ones-proto.jl` to `z2-magnetization-wolff-from-ones-compute.jl`.

Create `run-z2.sh` under `3d-ising-prototype\examples\z2`.

# 2021.9.24

Modify `z2-magnetization-wolff-from-ones-compute.jl` to 
- store magnetization data to a JLD file after the calculation
- report the progress via a text file during the calculation

Create `z2-direct-prototype` and `fermion-prototype`.

Create `infra` for a possible future unification of utilities used in QMC.

Download `output` generated by `3d-ising-prototype\examples\z2\z2-magnetization-wolff-from-ones-compute.jl` from the supercomputer. 
Rename it as `output-2021-9-24`.
Since the `data` file expected is not generated due to the time limit, we have to rely on `output` to draw the phase diagram.
The diagrams generated and the output files are stored in `3d-ising-prototype\examples\z2\2021-9-24`.

It is kind of surprising that there is a finite temperature phase transition. 
What is going on??

# 2021.9.25

Add support for square lattices in `z2-direct-prototype/lattice.jl`.

After several hours of work, I find that the code in `z2-direct-prototype` is already overengineered.

The current version of `z2-direct-prototype` is deprecated and is moved to `deprecated/2021-9-25`.

# 2021.10.8

The current pure Z2 gauge theory simulation is performed and the results are stored in `z2-direct-prototype\2021-10-8-run-1`.

It can be seen that with very small $h$ the update is not fast enough; also the temperature range is larger than needed.

Trying more detailed computation.

Changing the span of `T_range` and `h_range` in both `z2-direct-prototype` and `3d-ising-prototype\examples\z2` into smaller values.

Rename a few files in `z2-direct-prototype`.
Contents in the folder are then copied into a new folder `z2-and-ising`.
`main.jl` is moved to `z2-and-ising/examples/pure-z2`.

Another batch of data is retrieved and stored in `z2-direct-prototype\2021-10-8-run-2`.

Another batch of data is retrieved and stored in `3d-ising-prototype\examples\z2\2021-10-9`.

# 2021.10.14

`fermion-prototype` is deprecated.

# 2021.10.18

Try to simplify the lattice definition, and make `site_list` and `inverse_list` compatible with Julia's built-in arrays.

`z2-direct-prototype\lattice.jl` is modified.

`z2-direct-prototype\dev\test-tight-binding.jl` now contains some scratch about Trotter decomposed kinetic time evolution operators.

# 2021.10.19

Add `docs\lattice\lattice-representation.tex` which illustrate how the lattice is represented in the program.

Add `analytical\jxy-jtau-ratio\2d-tfim-to-3d-cim-v2.jl` to draw $J_{xy} / J_\tau$ in the correct way.
Currently `analytical\jxy-jtau-ratio\ratio-h=1.PNG` and `analytical\jxy-jtau-ratio\ratio-h=4.PNG` are not correct.

# 2021.10.20

`analytical\jxy-jtau-ratio\ratio-h-10-extreme-range.PNG` is generated using `analytical\jxy-jtau-ratio\2d-tfim-to-3d-cim-v2.jl`.

Create `analytical\sigma-product\sigma-product-z2-direct-prototype.jl` to define quantities used in the fermion DQMC, as well as verify whether everything is done right in `z2-direct-prototype`.

# 2021.10.30

Simplify the lattice module in `infra`. Codes from `z2-direct-prototype` is reused.

A much simpler version of 2D periodic square lattice is implemented and tested.

The contents of `infra` is then copied to `integrated-prototype`.

# 2021.10.31

First run of pure $\mathbb{Z}_2$ gauge theory, stored in `integrated-prototype\2021-10-31-1`.
The phase diagram `integrated-prototype\2021-10-31-1\z2-flux-average-phase-diagram.PNG` can be found 
to be almost exactly the same with `z2-direct-prototype\2021-10-8-run-2\z2-flux-average.PNG`, but the 
low temperature performance has been improved. (At the first glance the low transverse field performance is 
also improved, but that is just illusion because in `integrated-prototype\2021-10-31-1` we start from $h=0.2$ instead of $h=0.1$.)

Another batch of data - this time about the transverse field Ising model - is retrieved and stored in `integrated-prototype\2021-10-31-2`.

The horizontal strips found in the figure appear to come from the fact that different $T$ are mapped to the same $n_\tau$.

TODO:
- check whether a large n_sweep results in seemingly worse image quantities.

# 2021.11.29

Update notes.

# 2021.11.30

Completed parts involving $\bold{B}$ matrices. `G_τ_τ_def` seems to disagree with `G_τ_τ`.
Tests are being done in `integrated-prototype\z2-dqmc-test-2.jl`.

After some test the reason is found to be that in a downward `for` loop I forget to add a `-1`
step in the range.

TODO: It can be found that the accept rate is very close to 1 when $t \sim 1$, though the accept rates 
calculated with $\bold{B}$ matrices and Green functions agree with each other. Is it a problem?

With the current implementation the relative error of $\Delta$-matrices updating is $\sim 0.001$.
Not sure whether this is correct. 