\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{physics}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered, noend]{algorithm2e}
\usepackage[colorlinks]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

% Math operators
\DeclareMathOperator{\timeorder}{T}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Python-style code
\SetKwIF{If}{ElseIf}{Else}{if}{:}{elif:}{else:}{}
\SetKwFor{For}{for}{:}{}
\SetKwFor{While}{while}{:}{}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

\newcommand*{\Ztwo}{$\mathbb{Z}_2$ }
\newcommand*{\tfim}{transverse field Ising model }
\newcommand*{\TFIM}{Transverse Field Ising Model }
\newcommand*{\cim}{classical Ising model }
\newcommand*{\CIM}{Classical Ising Model }

\title{\Ztwo Gauge Field Coupled to a Fermion System}
\author{Jinyuan Wu}

\begin{document}

\maketitle

In the whole article we use $\sigma$ and $s$ as shorthands of $\sigma^z$ and $s^z$, unless confusion may be caused by the notation.

\section{The Model Hamiltonian}

The model investigated in this article is shown in \cite{moon2019deconfined}.
The model Hamiltonian is 
\begin{equation}
    H = H_Z \underbrace{- J \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma_{\vb*{i} \vb*{j}} s_{\vb*{i}} s_{\vb*{j}} + \sum_i h^x_i s^x_i}_{H_\text{Ising}} - t \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma_{\vb*{i} \vb*{j}} c^\dagger_{\vb*{i}} c_{\vb*{j}},
    \label{eq:proposed-model}
\end{equation}
where
\begin{equation}
    H_Z = - g \sum_{\vb*{l} \in \Box_{\vb*{i}^*}} \sigma_{\vb*{i} \vb*{j}}^z - h \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma^x_{\vb*{i} \vb*{j}}, 
\end{equation}
where $\vb*{i}^*$ is a site in the dual lattice (i.e. a site placed at the center of a plaquette), 
$\Box_{\vb*{i}^*}$ is the plaquette whose center is $\vb*{i}^*$, and $\vb*{l}$ denotes a certain bond of a plaquette.
Such kind of model Hamiltonian usually emerges from orthogonal metals \cite{moon2019deconfined, orthogonal_metal}.

In this section, we introduce every part of \eqref{eq:proposed-model}.

\subsection{\Ztwo Gauge Field and Its Dual Theories}

\subsubsection{The Plaquette Term}

\begin{figure}
    \centering
    \input{lattice/gauge-plaquette.tex}
    \caption{A \Ztwo gauge field configuration. The blue plaquette's $F_{\vb*{i}^*}$ is $(-1) \times 1 \times (-1) \times (-1) = -1$, %
    while the red plaquette's $F_{\vb*{i}^*}$ is $1 \times 1 \times (-1) \times (-1) = 1$. %
    Note that we assign the same index to a plaquette's center (labeled as $\vb*{i}^*$ at the right top of the diagram) %
    and the plaquette's left bottom site $\vb*{i}$. %
    The terms ``up'' and ``down'' are defined in the Cartesian coordinates given in the diagram.}
    \label{fig:z2-gauge-field}
\end{figure}

The plaquette term in the Hamiltonian of the \Ztwo gauge field is be a function of
\begin{equation}
    F_{i^*} = \prod_{l \in \Box_{i^*}} \sigma_l,
\end{equation}
which is invariant under a \Ztwo gauge transformation
\begin{equation}
    Q_{\vb*{i}} = \prod_{\vb*{l} \in +_{\vb*{i}}} \sigma^x_{\vb*{l}}.
\end{equation}
A convenient convention is to let a plaquette share the same index with the site in its left bottom corner. 
An example of a \Ztwo gauge field configuration can be found in \prettyref{fig:z2-gauge-field}.

\subsubsection{The Transverse Field}

We name the \Ztwo gauge theory with plaquette terms only as the \concept{Wegner model}, i.e.
\begin{equation}
    H_\text{W} = - g \sum_{\vb*{i}} F_{{\vb*{i}}^*}.
\end{equation}
There is no quantum fluctuation in $H_\text{W}$. 
The existence of interaction between the \Ztwo field and the Ising field and the fermions introduces effective interaction channels between \Ztwo excitations, but all effective interaction between \Ztwo excitations are in terms of $\sigma^z_{\vb*{i} \vb*{j}}$, which commutes with $H_Z$ and therefore do not bring in quantum fluctuation.

An idiomatic way to add quantum fluctuation is to add a transverse field.
In this project we consider a transverse field Hamiltonian in the form of 
\begin{equation}
    H_h = - h \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma_{\vb*{i} \vb*{j}}^x ,
    \label{eq:transverse-field}
\end{equation}
where the parameter $h$ measures the quantum fluctuation.
\eqref{eq:transverse-field} obviously commutes with $\vb*{Q}_{\vb*{i}}$ for every $\vb*{i}$, so it can be a term in a \Ztwo gauge invariant Hamiltonian. 
In the language of string-net condensation, $H_h$ is a string tension term.
So when we say ``\Ztwo gauge theory'', usually we are referring to 
\begin{equation}
    H = - J \sum_{\vb*{i}} \prod_{\vb*{l} \in \Box_{\vb*{i}^*}} \sigma_{\vb*{l}} - h \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma_{\vb*{i} \vb*{j}}^x.
    \label{eq:standard-z2-theory}
\end{equation}

\subsubsection{Equivalence between a \Ztwo Gauge Theory When $h = 0$ and a Bundle of Ising Chains}

\begin{figure}
    \centering
    \input{lattice/gauge-sublattice.tex}
    \caption{Dividing a gauge field configuration into two sublattices}
\end{figure}

Now we consider a \Ztwo field theory with the plaquette term only, or in other words, we investigate the Wegner model.
With the gauge choice
\begin{equation}
    \sigma_{\vb*{i}, \vb*{i}+\vu*{x}} = 1,
    \label{eq:gauge-choice-x}
\end{equation}
we have
\begin{equation}
    F_{i^*} = \sigma_{i, i+\hat{y}} \sigma_{i+\hat{x}, i + \hat{x} + \hat{y}},
\end{equation}
which, by renaming $\sigma_{i, i+\hat{y}}$ into $S_i$, reads 
\begin{equation}
    F_{i^*} = S_i S_{i+\hat{x}}.
\end{equation}
The hopping constant $\sigma_{\vb*{i} \vb*{j}}$, respectively, is
\begin{equation}
    \sigma_{\vb*{i} \vb*{j}} = \left\{
    \begin{aligned}
        1, &\quad j = i + \hat{x}, \\
        S_i, &\quad j = i + \hat{y},
    \end{aligned}
\right., \quad \sigma_{\vb*{j} \vb*{i}} = \sigma_{\vb*{i} \vb*{j}}.
\end{equation}

This, actually, means that the \Ztwo gauge field may also be transformed into a dual transverse field Ising field.
For example consider Wegner model.
With the definition of $S_i$s it is rephrased into
\begin{equation}
    H_\text{W} = -g \sum_i S_i S_{i+\hat{x}},
\end{equation}
so the model is actually a bundle of 1D Ising spin chain.

\begin{figure}
    \centering
    \input{lattice/gauge-to-spin-chain.tex}
    \caption{Converting a \Ztwo gauge field theory into a bundle of Ising chains. There is no interaction between parallel Ising chains.}
\end{figure}

\subsubsection{Mapping a \Ztwo Gauge Theory into a 2D \TFIM}

\begin{equation}
    H = - h \sum_{\pair{\vb*{I}, \vb*{J}}} \tau^z_{\vb*{I}} \tau^z_{\vb*{J}} - J \sum_{\vb*{I}} \tau^x_{\vb*{I}}.
    \label{eq:z2-dual-theory}
\end{equation}

\eqref{eq:z2-dual-theory} is often called the \concept{dual \tfim} of \Ztwo gauge theory \eqref{eq:standard-z2-theory}.

\subsubsection{Absence of a Finite Temperature Deconfined Phase}\label{sec:absence-of-z2-deconfined-phase}

When $T=0$ and $h \ll g$, the \Ztwo gauge field exhibits a \emph{deconfined} phase, i.e. there are freely moving \Ztwo excitations such as \Ztwo fluxes.

When $h = 0$, the absence of quantum fluctuation here means the model is indeed totally classical, so there is no thermal phase transition, because a 1D Ising chain does not show thermal phase transition.
On the other hand, we know when $T=0$ the model exhibits deconfined \Ztwo charges, and when a transverse field is introduced a zero temperature quantum phase transition can be observed from the deconfined phase into the confined phase as the transverse field grows.
If for $T > 0$ there exists a deconfined phase, a simple analysis of the phase diagram tells us there must be a thermal phase transition when there is no transverse field.
The fact that Wegner model is dual to a bundle of 1D Ising chain and therefore lacks thermal phase transition implies that no deconfined phase exists with finite non zero temperature.

\begin{figure}
    \centering
    \input{phase/no-deconfined.tex}
    \caption{No deconfined phase when $T > 0$: if there is a deconfined phase when $T > 0$, there must be a thermal phase transition at the $h=0$ line, which is forbidden by the fact that a classical 1D Ising chain does not show thermal phase transitions.}
\end{figure}

Here the terminology may cause confusion: we do not actually know if the "finite temperature deconfined" phase shares behavior with the standard zero temperature deconfined phase in Wegner model, and the "confined" phase in the high temperature condition is not caused by a strong transverse field which coerces all $\sigma$ degrees of freedom into $\rightarrow$ or $\leftarrow$, but rather, by thermal fluctuation that erases all information of \Ztwo excitations.
With the criteria of Wilson loops we know the "deconfined" phase obeys the perimeter law, agreeing with the ordinary deconfined phase in Wegner model, but whether the Wilson loop operator is a good detector in non-local models is still under question, because in local models, existence of long range correlation indicates exotic phenomena, while in non-local models long range correlation may be a trivial consequence of the non-locality.
All these questions remain open, and in this project we simply use the terms "confined" and "deconfined" as a shorthand of the two phases in a \Ztwo gauge field theory with a dual theory of Dyson-Ising spin chains, without inquiring into their similarity and discrepancy with local \Ztwo theories such as Wegner model.

\subsubsection{(Trivial) Deconfined Phase in Models with Long-range Interaction}

If we are to extend the deconfined phase to $T>0$, at least some stronger correlation must be introduced.
Without introducing quantum fluctuation, a reasonable proposal may be 
\[
    H_Z = - \sum_i \sum_{r=1}^\infty J(r) \prod_{a=0}^{r-1} F_{i^*+a \hat{x}},
\]
or in terms of $S_i$s,
\[
    H_Z = - \sum_{r=1}^\infty J(r) \sum_i S_i S_{i + r \hat{x}} ,
\]
which is again a bundle of spin chains without quantum fluctuation but this time with long range interaction.
A famous example is the \concept{Dyson-Ising chain}, which is defined as
\[
    H_Z = - g \sum_i S_i S_{i+\hat{x}} - J_r \sum_{\vb*{i}} \sum_r \frac{S_i S_{i + r \hat{x}}}{r^\omega}.
\]
For 1D Ising chain with long-range interaction, there exists a thermal phase transition with zero transverse field, and indeed we get a deconfined phase with finite temperature, and as the temperature goes up the deconfined phase switches to the confined phase.

However, the so-called deconfined phase of a long-range interacting model is not of particular interest, because if you put manually something long-range into a model, \emph{of course} it exhibits some long-range behaviors, for example Wilson loops obeying the perimeter law.
That is why we call such a ``deconfined phase'' a trivial one.
Despite its triviality, ``deconfined'' phases in long-range models give us a hint that strong interaction between \Ztwo fluxes is important for a thermal deconfined phase.
A natural question to ask is, if we introduce more things into the model to induce effective interaction channels between \Ztwo fluxes, what happens when $T > 0$?

\subsection{Orthogonal metals, emergent fermions and an Ising field}

\subsubsection{Fermion fractionalization in orthogonal metals and the effective model}

Orthogonal metal is a type of fractionalized electron systems where an electron is split into another fermion and an Ising spin, i.e.
\begin{equation}
    c^\dagger_{\vb*{i} \alpha} = f^\dagger_{\vb*{i} \alpha} \sigma^z_{\vb*{i}}, 
    \label{eq:orthogonal-metal-ansatz}
\end{equation}
where $f$ operators and $\sigma^z$ operators commute and $f^\dagger_{\vb*{i} \alpha}$ fermions can move around freely. 
Since the Hilbert space spanned by the $f$ fermions and Ising spins are larger than the original electronic system's Hilbert space, certain constraints must be imposed, resulting in an emergent gauge field, gluing up $f$ and $\sigma$ fields.

That justifies the way we construct \eqref{eq:proposed-model}.
Suppose we have a tight-binding electron models with certain interaction channels that are strong enough to create a non-Fermi liquid phase, the Hamiltonian of which is 
\begin{equation}
    H = - t \sum_{\pair{\vb*{i}, \vb*{j}}, \alpha} c^\dagger_{\vb*{i} \alpha} c_{\vb*{j} \alpha} + \sum_{\vb*{i}, \vb*{j}} V_{\vb*{i} \vb*{j}} n_{\vb*{i}} n_{\vb*{j}}.
    \label{eq:electron-hamiltonian}
\end{equation}
Substituting \eqref{eq:orthogonal-metal-ansatz} into \eqref{eq:electron-hamiltonian} and doing necessary mean field approximations, we find that the Hamiltonian about $f$ fermions in the model is also a tight-binding Hamiltonian with its hopping constants being the same as $\sigma_{\vb*{i} \vb*{j}}$, which couples the fermions with the \Ztwo gauge field, endowing the fermions \Ztwo charges.

The idea of orthogonal metals gives us an approach to find a local \Ztwo gauge model that shows deconfined phase at finite temperature.
Our logic is the inverse of the derivation of orthogonal metals: if an orthogonal metal with \Ztwo gauge structure does exist, then it can be described by \eqref{eq:proposed-model}.
That implies the existence of a model Hamiltonian in the form of \eqref{eq:proposed-model} with a deconfined phase.
Our goal is, therefore, to check under what condition \eqref{eq:proposed-model} \emph{can never} be in a deconfined phase.

\subsubsection{Confined phase in orthogonal metals}

When the \Ztwo charges get trapped into a confined phase, it can be expected that the fermions and the Ising spins are also confined.
Note that what the composite particles generated by the gauge field as a glue in the confined phase are is not quite clear.
One possibility is that the fermions are glued together, forming something like Cooper pairs, where the fermion excitations are now gapped.
Nonetheless, note that orthogonal metals are generated in a strongly correlated \emph{electron} systems, so it is highly likely that \emph{one fermion and one Ising spin} are glued together, restoring the electrons.
In this case, the confined phase is just an ordinary metal, with gapless fermions (electrons).
At high temperature \Ztwo excitations are confined (in the sense defined in \prettyref{sec:absence-of-z2-deconfined-phase}), so \eqref{eq:proposed-model} is just an ordinary metal.

\section{Principles of Monte Carlo simulation: path integral, fermions and more}

We are going to study \eqref{eq:proposed-model} numerically.
In the partition function, the (non-normalized) weight of a configuration is $\mel{n}{\ee^{-\beta H}}{n}$, given that $\{\ket{n}\}$ is a basis.
We use a discrete path integral method to evaluate these weights.

We introduce a Trotter decomposition with imaginary time step $\Delta \tau = \beta / m$, choose $\sigma_{\vb*{i} \vb*{j}}, s_{\vb*{i}}$ as labels for the \Ztwo field and the Ising field, respectively, and integrate out the fermion hopping term. 
Now a configuration of the systems is a sequence of length $m$, and at each imaginary time point $\tau$ there is a \Ztwo field $\sigma_{\vb*{i} \vb*{j}}(\tau)$ and an Ising field $s_{\vb*{i} \vb*{j}}(\tau)$.
The weight of a configuration is 
\[
    \begin{aligned}
        W(\sigma, s) &= \trace_\text{fermion} \prod_{\tau = 1}^{m\Delta \tau} \mel{(\sigma, s)(\tau+\Delta \tau)}{\ee^{-\Delta \tau H_Z} \ee^{- \Delta \tau H_\text{Ising}}}{(\sigma, s)(\tau)} \ee^{\Delta \tau t \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma_{\vb*{i} \vb*{j}}(\tau) c_i^\dagger c_{\vb*{j}}} \\
        &= \prod_{\tau = 1}^{m\Delta \tau} \mel{(\sigma, s)(\tau+\Delta \tau)}{\ee^{-\Delta \tau H_Z} \ee^{- \Delta \tau H_\text{Ising}}}{(\sigma, s)(\tau)} \det \left(1 + \prod_{\tau = 1}^{m\Delta \tau} \ee^{\Delta \tau t \sigma(\tau)}\right) \\
        &= \prod_{\tau = 1}^{m\Delta \tau} \mel{\sigma(\tau + \Delta \tau)}{\ee^{-\Delta \tau H_Z}}{\sigma(\tau)} \mel{s(\tau + \Delta \tau)}{\ee^{-\Delta \tau H_\text{Ising}|_{\sigma(\tau)}}}{s(\tau)} \det \left(1 + \prod_{\tau = 1}^{m\Delta \tau} \ee^{\Delta \tau t \sigma(\tau)}\right).
    \end{aligned}
\]
where $\sigma = \{\sigma_{\vb*{i} \vb*{j}}(\tau)\}$ and $s = \{s_{\vb*{i}}(\tau)\}$, 
and in the last line values of $\sigma(\tau)$ replaces the $\sigma^z$ operators in $H_\text{Ising}$.

\subsection{Path integral for 2D \TFIM}

\subsubsection{From 2D \TFIM to 3D \CIM}

In this section we use $\sigma$ to denote spin-$1/2$ degrees of freedom in a 2D \tfim.
This notation conflicts with the symbol $\sigma$ for \Ztwo gauge field, 
and is inconsistent with the symbol $s$ for the Ising field, 
but since we do not deal with the complete \eqref{eq:proposed-model} it does not matter.
We also let $\sigma^z = \{\sigma^z_{\vb*{i}}(\tau)\}$ be the field configuration at $\tau$.

The \tfim is 
\begin{equation}
    H_\text{TFIM} = - J \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma^z_{\vb*{i}} \sigma^z_{\vb*{j}} + h \sum_{\vb*{i}} \sigma^x_{\vb*{i}}.
    \label{eq:tfim-hamiltonian}
\end{equation}
An imaginary time step in the path integral of \eqref{eq:tfim-hamiltonian} is 

\[
    \begin{aligned}
        \mel{\sigma^z(\tau + \Delta \tau)}{\ee^{-\Delta \tau {H}}}{\sigma^z(\tau)} &= \mel{\sigma^z(\tau + \Delta \tau)}{\ee^{- \Delta \tau \sum_{\vb*{i}} h {\sigma}^x_{\vb*{i}}} \ee^{\Delta \tau \sum_{\pair{\vb*{i}, \vb*{j}}} J {\sigma}_{\vb*{i}}^z {\sigma}_{\vb*{j}}^z}}{\sigma^z(\tau)} \\
        &= \ee^{\Delta \tau \sum_{\pair{\vb*{i}, \vb*{j}}} J \sigma_{\vb*{i}}^z \sigma_{\vb*{j}}^z} \mel{\sigma^z(\tau + \Delta \tau)}{\ee^{- \Delta \tau \sum_{\vb*{i}} h {\sigma}^x_{\vb*{i}}}}{\sigma^z(\tau)} \\
        &= \ee^{\Delta \tau \sum_{\pair{\vb*{i}, \vb*{j}}} J \sigma_{\vb*{i}}^z \sigma_{\vb*{j}}^z} \sum_{\{\sigma^x_{\vb*{i}}\}} \ee^{- \Delta \tau \sum_{\vb*{i}} h \sigma^x_{\vb*{i}}} \braket{\sigma^z(\tau + \Delta \tau)}{\sigma^x} \braket{\sigma^x}{\sigma^z(\tau)} \\
        &= \ee^{\Delta \tau \sum_{\pair{\vb*{i}, \vb*{j}}} J \sigma_{\vb*{i}}^z \sigma_{\vb*{j}}^z} \prod_{\vb*{i}} \sum_{\sigma^x_{\vb*{i}}} \ee^{- \Delta \tau h \sigma^x_{\vb*{i}}} \braket{\sigma^z_{\vb*{i}}(\tau + \Delta \tau)}{\sigma^x_{\vb*{i}}} \braket{\sigma^x_{\vb*{i}}}{\sigma^z_{\vb*{i}}(\tau)} \\
        &= \ee^{\Delta \tau \sum_{\pair{\vb*{i}, \vb*{j}}} J \sigma_{\vb*{i}}^z \sigma_{\vb*{j}}^z} \prod_{\vb*{i}} \sum_{\sigma^x_{\vb*{i}} = \pm 1} \ee^{- \Delta \tau h \sigma^x_{\vb*{i}}} \frac{1}{2} \ee^{\ii \pi \frac{1 - \sigma^x_{\vb*{i}}}{2} \left( \frac{1 - \sigma^z_{\vb*{i}}(\tau)}{2} + \frac{1 - \sigma^z_{\vb*{i}}(\tau + \Delta \tau)}{2} \right)} \\
        &= \frac{1}{2^N} \ee^{\Delta \tau \sum_{\pair{\vb*{i}, \vb*{j}}} J \sigma_{\vb*{i}}^z \sigma_{\vb*{j}}^z} \prod_{\vb*{i}} \left( \ee^{- \Delta \tau h} + \ee^{\Delta \tau h} \ee^{\ii \pi \frac{1 - \sigma^z_{\vb*{i}}(\tau)}{2}} \ee^{\ii \pi \frac{1 - \sigma^z_{\vb*{i}}(\tau + \Delta \tau)}{2}} \right) \\
        &= \frac{1}{2^N} \ee^{\Delta \tau \sum_{\pair{\vb*{i}, \vb*{j}}} J \sigma_{\vb*{i}}^z \sigma_{\vb*{j}}^z} \prod_{\vb*{i}} \left( \ee^{- \Delta \tau h} + \ee^{\Delta \tau h} \sigma^z_{\vb*{i}}(\tau) \sigma^z_{\vb*{i}}(\tau + \Delta \tau) \right).
    \end{aligned}
\]
And since $\sigma_{\vb*{i}}^z = \pm 1$, we have
\[
    \cosh J_\tau + \sinh J_\tau \sigma^z_{\vb*{i}}(\tau) \sigma^z_{\vb*{i}}(\tau + \Delta \tau) = \ee^{J_\tau \sigma^z_{\vb*{i}}(\tau) \sigma^z_{\vb*{i}}(\tau + \Delta \tau)},
\]
so 
\[
    \ee^{- \Delta \tau h} + \ee^{\Delta \tau h} \sigma^z_{\vb*{i}}(\tau) \sigma^z_{\vb*{i}}(\tau + \Delta \tau) \propto \ee^{J_\tau \sigma^z_{\vb*{i}}(\tau) \sigma^z_{\vb*{i}}(\tau + \Delta \tau)},
\]
where
\[
    \tanh J_\tau = \ee^{2 \Delta \tau h}.
\]
So the discrete path integral of \eqref{eq:tfim-hamiltonian} with time step $\Delta \tau$ shares its weights with the partition function of the \cim
\begin{equation}
    H = - J_{xy} \sum_{\tau, \text{ spacial $\pair{\vb*{i}, \vb*{j}}$}} \sigma_{\vb*{i} \tau} \sigma_{\vb*{j} \tau} - J_\tau \sum_{\tau, \vb*{i}} \sigma_{\vb*{i} \tau} \sigma_{\vb*{i}, \tau + \Delta \tau}
    \label{eq:cim-from-tfim} 
\end{equation}
at $T = 1$, where
\begin{equation}
    J_{xy} = \Delta \tau J, \quad \tanh J_\tau = \ee^{2 \Delta \tau h}.
\end{equation}

% TODO: the figures used in the following figure are wrong.
\begin{figure}
    \centering
    \begin{subfigure}{0.48\textwidth}
        \includegraphics[width=\textwidth]{montecarlo/ratio-h=1.PNG}
        \subcaption{$h = 1$}
    \end{subfigure}
    \begin{subfigure}{0.48\textwidth}
        \includegraphics[width=\textwidth]{montecarlo/ratio-h=4.PNG}
        \subcaption{$h = 4$}
    \end{subfigure}
    \caption{$J_{xy} / J_\tau$ under different $h$. 
    It can be seen that \eqref{eq:cim-from-tfim} is highly anisotropic for a large range of $J$.
    Contour lines in (a) are straight, indicating that the discrete path integral works well even with large $\Delta \tau$, 
    while contour lines in (b) are distorted, requiring us to use $\Delta \tau$ that is small enough.}
    \label{fig:jxy-jtau-ratio}
\end{figure}

It should be noted that \eqref{eq:cim-from-tfim} may be highly anisotropic between time and space, 
which can be observed in \prettyref{fig:jxy-jtau-ratio}.
Another fact that can be read from \prettyref{fig:jxy-jtau-ratio} is that for large $h$ $\Delta \tau$ should be smaller to keep the same accuracy.
The larger $h$ is, the stronger the quantum fluctuation is, 
and with strong quantum fluctuation $\Delta \tau$ must be small enough to accurately track the time evolution.

\subsubsection{Cluster update algorithm along the temporal direction}

The anisotropic feature of \eqref{eq:cim-from-tfim} is tackled in \cite{Blte2002}.

We did a benchmark of our algorithm with data provided in \cite{Friedman_1978}.

\subsubsection{Worm Algorithm for 2D \TFIM}

Another way to simulate 2D \tfim is described in \cite{Huang_2020}.
We do the following (canonical) substitution
\begin{equation}
    \sigma_{\vb*{i}}^x \longrightarrow - \sigma^z_{\vb*{i}}, \quad \sigma_{\vb*{i}}^z \longrightarrow - \sigma^x_{\vb*{i}}, \quad \sigma^y_{\vb*{i}} \longrightarrow - \sigma^y_{\vb*{i}}
\end{equation}
in \eqref{eq:tfim-hamiltonian}, and obtain
\begin{equation}
    H = - J \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma^x_{\vb*{i}} \sigma^x_{\vb*{j}} - h \sum_{\vb*{i}} \sigma^z_{\vb*{i}}.
    \label{eq:tfim-string-form}
\end{equation}
which can be viewed as a string-net model, where the $\sum \sigma^z$ term is string tension term and the other term is the string kinetic term.
The ends of a $\sigma^z$ string are two sites on which $\sigma^z = -1$, as opposed to the ``vacuum'' case where $\sigma^z = 1$.
We define the ladder operators in the standard way
\begin{equation}
    \sigma^\pm_{\vb*{i}} = \frac{\sigma^x_{\vb*{i}} \pm \ii \sigma^y_{\vb*{i}}}{2},
\end{equation}
then \eqref{eq:tfim-string-form} turns into
\begin{equation}
    H = - J \sum_{\pair{\vb*{i}, \vb*{j}}} (\sigma^+_{\vb*{i}} \sigma^-_{\vb*{j}} + \sigma^+_{\vb*{i}} \sigma^+_{\vb*{j}} + \text{h.c.}) - h \sum_{\vb*{i}} \sigma_{\vb*{i}}^z,
    \label{eq:tfim-string-fragments}
\end{equation}
which can also be rewrite into one of hardcore boson model.

\begin{figure}
    \centering
    \begin{subfigure}{0.48\textwidth}
        \input{lattice/string-creation.tex}
        \subcaption{}
    \end{subfigure}
    \begin{subfigure}{0.48\textwidth}
        \input{lattice/string-move.tex}
        \subcaption{}
    \end{subfigure}
    \caption{String fragments provided in \eqref{eq:tfim-string-fragments}. 
    (a) corresponds to the $\sigma^+ \sigma^+$ term, where a minimal string is created out of nothing, 
    or in other words, two magnons are created out of nothing.
    (b) corresponds to the $\sigma^+ \sigma^-$ term, which extends an existing string, 
    or in other words, a magnon is moved to its nearest neighbor. 
    The time inverse of (a) and (b) can be easily found, which are annihilation of a minimal string and shortening an existing string, correspondingly.}
    \label{fig:tfim-string-fragments}
\end{figure}

The $\sigma^z$ strings can expand and shrink, and their ends can hop from one site to its neighbors, 
according to the first four terms in the Hamiltonian, which are factories of string fragments.
This is visualize in \prettyref{fig:tfim-string-fragments}.
It should be noted that the $\sigma^+ \sigma^+$ term only applies to vacuum, or otherwise it just returns zero.
Likewise, the $\sigma^+ \sigma^-$ term only applies to existing strings, or otherwise it just returns zero.
Two or more minimal strings can be created at the same time, 
so effectively, a prolonged string can be generated from vacuum in just one time step.
As a result, the field configuration used in the path integral is something like this: 
a string is created, and then distorted, and finally annihilated.
So each field configuration used in the path integral is a set of \emph{closed} strings or loops, 
which are just \emph{world lines} of magnons, as is depicted in \prettyref{fig:tfim-worldline}.

\begin{figure}
    \centering
    \input{lattice/worldline.tex}
    \caption{World lines of magnons in a \tfim model, under the periodic boundary condition. Note that a loop can go across the boundary.}
    \label{fig:tfim-worldline}
\end{figure}

Now we write down the partition function in the path integral form.

\subsection{Quantum fluctuation introduced by $H_h$}

With the presence of $H_h$, the $H_Z$ factor of each imaginary time step reads
\[
    \begin{aligned}
        &\quad \mel{\sigma(\tau + \Delta \tau)}{\ee^{-\Delta \tau H_{Z0}} \ee^{-\Delta \tau H_h}}{\sigma(\tau)} \\ 
        &= \ee^{-\Delta \tau H_{Z0}|_{\sigma(\tau)}} \sum_{\sigma^x} \ee^{-\Delta \tau H_h|_{\sigma^x}} \braket{\sigma^z(\tau+\Delta \tau)}{\sigma^x} \braket{\sigma^x}{\sigma^z(\tau)} \\
        &= \ee^{-\Delta \tau H_{Z0}|_{\sigma(\tau)}} \sum_{\sigma^x} \ee^{h \Delta \tau \sum_{\pair{\vb*{i}, \vb*{j}}} \sigma^x_{\vb*{i} \vb*{j}}} \braket{\sigma^z(\tau+\Delta \tau)}{\sigma^x} \braket{\sigma^x}{\sigma^z(\tau)} \\
        &= \ee^{-\Delta \tau H_{Z0}|_{\sigma(\tau)}} \prod_{\text{bond } l} \sum_{\sigma^x_l =\pm 1} \ee^{h \Delta \tau \sigma^x_l} \braket{\sigma^z_l(\tau+\Delta \tau)}{\sigma^x_l} \braket{\sigma^x_l}{\sigma^z_l(\tau)} \\
        &= \ee^{-\Delta \tau H_{Z0}|_{\sigma(\tau)}} \prod_{\text{bond } l} \sum_{\sigma^x_l =\pm 1} \ee^{h \Delta \tau \sigma^x_l} \braket{\sigma^z_l(\tau+\Delta \tau)}{\sigma^x_l} \braket{\sigma^x_l}{\sigma^z_l(\tau)}.
    \end{aligned}
\]
By the formula
\[
    \braket{\sigma^x_l}{\sigma^z_l(\tau)} = \frac{1}{\sqrt{2}} \ee^{\ii \pi \frac{1 - \sigma^x_l}{2} \frac{1 - \sigma^z_l(\tau)}{2}} ,
\]
we have
\[
    \begin{aligned}
        &\quad \mel{\sigma(\tau + \Delta \tau)}{\ee^{-\Delta \tau H_{Z0}} \ee^{-\Delta \tau H_h}}{\sigma(\tau)} \\
        &= \ee^{-\Delta \tau H_{Z0}|_{\sigma(\tau)}} \prod_{\text{bond } l} \sum_{\sigma^x_l =\pm 1} \ee^{h \Delta \tau \sigma^x_l} \frac{1}{2} \ee^{\ii \pi \frac{1 - \sigma^x_l}{2} \frac{1 - \sigma^z_l(\tau)}{2}} \ee^{\ii \pi  \frac{1 - \sigma^x_l}{2} \frac{1 - \sigma^z_l(\tau + \Delta \tau)}{2}} \\
        &= \frac{1}{2^{2N}} \ee^{-\Delta \tau H_{Z0}|_{\sigma(\tau)}} \prod_{\text{bond } l} \left( \ee^{h \Delta \tau} + \ee^{- h \Delta \tau} \ee^{\ii \pi (\frac{1 - \sigma^z_l(\tau)}{2} + \frac{1 - \sigma^z_l(\tau + \Delta \tau)}{2})} \right) \\
        &= \frac{1}{2^{2N}} \ee^{-\Delta \tau H_{Z0}|_{\sigma(\tau)}} \prod_{\text{bond } l} \left( \ee^{h \Delta \tau} + \ee^{- h \Delta \tau} \sigma_l^z(\tau) \sigma_l^z(\tau + \Delta \tau) \right) \\
        &= \frac{1}{2^{2N}} \ee^{-\Delta \tau H_{Z0}|_{\sigma(\tau)}} \prod_{\text{bond } l} \ee^{J_\tau \sigma_l^z(\tau) \sigma_l^z(\tau + \Delta \tau)}.
    \end{aligned}
\]
where 
\begin{equation}
    \tanh J_\tau = \ee^{-2 h \Delta \tau}.
\end{equation}
The last few steps all use the fact that $\sigma^z_l = \pm 1$.
With the gauge $\sigma_{i, i+\hat{x}} = 1$, the weight 

\section{Monte Carlo Simulation of the Pure \Ztwo Gauge Theory with Gauge \eqref{eq:gauge-choice-x}}

\subsection{The Phase Diagram}

\begin{figure}
    \centering
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{phase/phase-diagram-transverse-ising-metropolis.PNG}
        \subcaption{}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \centering
        \includegraphics[width=\textwidth]{phase/phase-diagram-transverse-ising-wolff.PNG}
        \subcaption{}
    \end{subfigure}
    \caption{Phase diagrams of 1D transverse field Ising chain obtained with different updating algorithms. The $x$ coordinate is $h$ and the $y$ coordinate is $T$. (a) Metropolis algorithm (b) Wolff cluster algorithm. 
    It can be seen that Metropolis algorithm does not work well when $h$ is small.}
    \label{fig:comparision-metropolis-wolff}
\end{figure}

Since $J_x$ and $J_y$ differ a lot, Metropolis algorithm is incapable for the simulation of the anisotropic Ising model.
Cluster update methods - in this project Wolff cluster updating \cite{Wolff_1989} - must be used.
\prettyref{fig:comparision-metropolis-wolff} shows a comparison between Metropolis algorithm and Wolff algorithm, 
where Metropolis algorithm cannot update the system sufficiently when $h=0$, 
since in that case the 2D \cim corresponding to the 1D transverse field Ising chain degenerates into a classical 1D Ising chain due to the vanishing quantum fluctuation, 
so the coupling strength in the temporal direction approaches to infinite.

\section{Monte Carlo Simulation of the Pure \Ztwo Theory's Dual Transverse Field Ising Model}

\subsection{Benchmark of the Algorithms}

\subsubsection{Metropolis and Wolff update for \CIM}

\begin{figure}
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{../3d-ising-prototype/examples/isotropic/magnetization-metropolis-random-init.PNG}
        \subcaption{Metropolis, random initial configuration}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{../3d-ising-prototype/examples/isotropic/magnetization-metropolis-ones-init.PNG}
        \subcaption{Metropolis, initially FM}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{../3d-ising-prototype/examples/isotropic/magnetization-wolff-random-init.PNG}
        \subcaption{Wolff, random initial configuration}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{../3d-ising-prototype/examples/isotropic/magnetization-wolff-ones-init.PNG}
        \subcaption{Wolff, initially FM}
    \end{subfigure}
    \caption{Simulation of 3D \cim using Metropolis update and Wolff update. The data of the straight lines comes from \cite{Talapov_1996}.}
    \label{fig:3d-cim-benchmark}
\end{figure}

\section{Monte Carlo Simulation of \eqref{eq:proposed-model}}

The way to update fermions can be found in the appendix of \cite{Chen_2021}.

\bibliographystyle{plain}
\bibliography{note} 

\end{document}